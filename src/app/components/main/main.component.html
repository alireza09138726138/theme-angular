<div class="container py-5">

  <h2>welcome</h2>
  <a class="btn btn-info" uiSref="setting">Setting</a>


  <div class="row my-2">


    <!-- Tasks -->
    <!-- if setting change save dont show tasks -->
    <div class="col-lg-6" *ngIf="!setting.enableTask">

      <!-- Add group -->
      <form (ngSubmit)="addGroup()">
        <input type="text" class="form-control" placeholder="Add a group" [(ngModel)]="groupToAdd" name="groupToAdd"
          autocomplete="off">
      </form>

      <!-- Groups -->
      <div class="card my-3 " *ngFor="let group of groups">
        <!-- Group name @todo Add delete button at the right side of head -->
        <div class="card-header d-flex">{{ group.name }}
          <!-- Mutlti select action -->
          <button class="btn btn-sm btn-light mr-auto"
            (click)="deleteSelected(group.showArchived ? group.archivedTasks : group.tasks)">Done selected</button>
          <!-- Archive   -->
          <button class="btn btn-sm btn-light py-0 mr-1 btn-outline-dark"
            (click)="group.showArchived = !group.showArchived">
            {{ group.showArchived ? 'Hide' : 'Show' }} Archived
          </button>
          <!-- Delete -->
          <button class="btn btn-sm btn-light py-0 btn-outline-dark" (click)="deleteGroup(group)">X</button>
          <button class="btn btn-sm btn-light py-0 btn-outline-dark" (click)="deleteAll(group)">X</button>
        </div>
        <!-- Group body -->
        <div class="card-body">
          <!-- Group add input -->
          <form class="mb-3" (ngSubmit)="addTask(group)">
            <div class="input-group ">
              <input type="text" placeholder="Add task" class="form-control" [(ngModel)]="taskToAdd" name="taskToAdd">
              <input type="date" class="form-control" [(ngModel)]="taskDateToAdd" name="taskDateToAdd">
            </div>
          </form>
          <!-- Group task list -->
          <div class="list-group-item task"
            *ngFor="let task of ( group.showArchived ? group.archivedTasks : group.tasks); let index = index"
            [ngClass]="{'done': task.done, 'bg-light': task.pin, 'bg-primary': task.selected }">
            <!-- Task done -->
            <div class="form-group form-check d-inline">
              <input type="checkbox" class="form-check-input" [(ngModel)]="task.done" (ngModelChange)="saveGroup()">
            </div>
            <!-- Select  -->
            <button class="btn btn-light btn-sm" (click)="task.selected = !task.selected">Select</button>
            <!-- Task name -->
            <span>{{ task.name }}</span>
            <!-- Task date -->
            <small *ngIf="task.date"><br>{{ task.date | date:'MMM d, y' }}</small>
            <!-- Pin -->
            <button class="btn btn-sm btn-light float-right py-0" (click)="pinTask(task)">P</button>
            <!-- Delete -->
            <button class="btn btn-sm btn-light float-right py-0"
              (click)="deleteTask(group.showArchived ? group.archivedTasks : group.tasks, index)">X</button>
            <!-- Archive -->
            <button class="btn btn-sm btn-light float-right py-0" (click)="archive(group, task, index)">A</button>
          </div>
          <!-- No tasks text -->
          <div *ngIf="!group.tasks.length && !group.showArchived" class="mt-3 text-secondary text-center">
            You don't have any tasks.
          </div>
          <!-- No archived tasks text -->
          <div *ngIf="!group.archivedTasks.length && group.showArchived" class="mt-3 text-secondary text-center">
            You don't have any archived tasks.
          </div>
        </div>
      </div>
    </div>


    <!-- Notes -->
    <div class="col-lg-6" *ngIf="!setting.enableNote">

      <!-- Add note -->
      <form (ngSubmit)="addNote()">
        <input type="text" placeholder="Add a note" class="form-control" [(ngModel)]="noteToAdd" name="noteToAdd"
          autocomplete="off">
      </form>

      <!-- List of notes -->
      <div class="card my-3 bg-{{ note.color }} " *ngFor="let note of notes">
        <div class="card-body" *ngIf="!note.length">
          {{ note.content }}
          <!-- Buttons -->
          <div class="float-right">
            <!-- Color dropdown -->
            <div class="dropdown d-inline">
              <button class="btn btn-sm btn-outline-dark dropdown-toggle mr-1" data-toggle="dropdown"></button>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'white')">White</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'info')">Info</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'danger')">Danger</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'primary')">Primary</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'warning')">Warning</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'success')">Success</a>
                <a class="dropdown-item" href="#" (click)="setNoteColor(note, 'secondary')">Secondary</a>
              </div>
            </div>
            <!-- Delete button -->
            <button class="btn btn-sm btn-outline-dark" (click)="deleteNote()">&times;</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
